import{r as v,a as O,b as z,j as Y,e as H,f as W,h as L,u as N,t as S,o as B}from"./entry.872d718e.js";import{_ as V}from"./_plugin-vue_export-helper.c27b6911.js";let f;const D=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});D.decode();let k=new Uint8Array;function X(){return k.byteLength===0&&(k=new Uint8Array(f.memory.buffer)),k}function $(e,t){return D.decode(X().subarray(e,e+t))}function J(e){return()=>{throw new Error(`${e} is not defined`)}}class A{static __wrap(t){const n=Object.create(A.prototype);return n.ptr=t,n}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();f.__wbg_universe_free(t)}static new(t,n){const i=f.universe_new(t,n);return A.__wrap(i)}tick(){f.universe_tick(this.ptr)}cells(){return f.universe_cells(this.ptr)}toggle_cell(t,n){f.universe_toggle_cell(this.ptr,t,n)}destroy(){f.universe_destroy(this.ptr)}}async function K(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(i){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function Q(){const e={};return e.wbg={},e.wbg.__wbg_random_656f2ae924b2540e=typeof Math.random=="function"?Math.random:J("Math.random"),e.wbg.__wbindgen_throw=function(t,n){throw new Error($(t,n))},e}function Z(e,t){return f=e.exports,E.__wbindgen_wasm_module=t,k=new Uint8Array,f}async function E(e){typeof e>"u"&&(e=new URL(""+new URL("conway_bg.75b63e44.wasm",import.meta.url).href,self.location));const t=Q();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:i}=await K(await e,t);return Z(n,i)}const ee={class:"Game__controlsContainer"},te={__name:"rust",setup(e){const t=v(null),{public:{rust:n,BITS_PER_BYTE:i}}=O(),M=v(null);let d=null,x=null;const C=v(!1),l=v(null);let a=null,[c,u]=[0,0],y=[];const r=n.sizeCell+1;z(async()=>{await Y(),t.value=await E(),c=Math.ceil(M.value.offsetWidth/r),u=Math.ceil(M.value.offsetHeight/r),d=A.new(c,u),y=Array.from(new Array(u),()=>new Array(c)),l.value.width=c*r+1,l.value.height=u*r+1,a=l.value.getContext("2d"),a.strokeStyle=n.colorDefault,a.fillStyle=n.colorDefault,R()}),H(()=>{G(),d.destroy()});function R(){a.clearRect(0,0,l.value.width,l.value.height),P(),F()}function P(){let[w,o]=[c,u];for(a.beginPath();w--;)a.moveTo(w*r+1,0),a.lineTo(w*r+1,u*r+1);for(;o--;)a.moveTo(0,o*r+1),a.lineTo(c*r+1,o*r+1);a.stroke()}function F(){const w=d.cells(),o=new Uint8Array(t.value.memory.buffer,w,c*u/i),m=(s,_)=>y[s][_]!==void 0?y[s][_]:y[s][_]=s*c+_,g=(s,_,T)=>{const p=m(s,_),U=Math.floor(p/i),b=1<<p%i;return(T[U]&b)===b};a.beginPath();let h=u;for(;h--;){let s=c;for(;s--;)g(h,s,o)&&a.fillRect(s*r+1,h*r+1,r,r)}a.stroke()}function I(){d.tick(),R(),C.value=!0,x=requestAnimationFrame(I)}function G(){cancelAnimationFrame(x),C.value=!1,x=null}function j({clientX:w,clientY:o}){const{width:m,height:g,left:h,top:s}=l.value.getBoundingClientRect(),[_,T]=[l.value.width/m,l.value.height/g],[p,U]=[(w-h)*_,(o-s)*T],[b,q]=[Math.min(Math.floor(U/r),g-1),Math.min(Math.floor(p/r),m-1)];d.toggle_cell(b,q),R()}return(w,o)=>(B(),W("div",{class:"Game__container",ref_key:"container",ref:M},[L("canvas",{class:"Game",ref_key:"grid",ref:l,onClick:j},null,512),L("div",ee,[N(C)?(B(),W("button",{key:0,onClick:o[0]||(o[0]=S(()=>G(),["stop","prevent"]))}," ⏸ pause ")):(B(),W("button",{key:1,variant:"primary",onClick:o[1]||(o[1]=S(()=>I(),["stop","prevent"]))}," ▶️ play "))])],512))}},ae=V(te,[["__scopeId","data-v-d83f12f2"]]);export{ae as default};
